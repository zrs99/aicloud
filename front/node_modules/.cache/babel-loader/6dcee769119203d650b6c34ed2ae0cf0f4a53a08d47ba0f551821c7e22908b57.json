{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { ref, onMounted, onUnmounted } from 'vue';\nimport * as pdfjsLib from 'pdfjs-dist/build/pdf';\n// import pdfjsWorker from 'pdfjs-dist/build/pdf.worker.min?url'\n\n// 配置 PDF.js worker\n// pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorker\n// pdfjsLib.GlobalWorkerOptions.workerSrc =\n//   'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.worker.min.js'\n\nexport default {\n  __name: 'PDFViewer',\n  props: {\n    pdfUrl: {\n      type: String,\n      required: true\n    },\n    scale: {\n      type: Number,\n      default: 1.5\n    },\n    bufferPages: {\n      type: Number,\n      default: 2\n    }\n  },\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const setupPDFWorker = () => {\n      try {\n        // 尝试方案1：Vite专用导入\n        import('pdfjs-dist/build/pdf.worker.min?url').then(worker => {\n          pdfjsLib.GlobalWorkerOptions.workerSrc = worker.default;\n        });\n      } catch {\n        try {\n          // 方案2：使用CDN回退\n          pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.worker.min.js';\n        } catch {\n          // 方案3：降级模式\n          console.warn('使用无Worker模式，性能可能受影响');\n          pdfjsLib.disableWorker = true;\n        }\n      }\n    };\n    const props = __props;\n\n    // Refs\n    const scrollContainer = ref(null);\n    const pageCanvases = ref([]);\n    const renderTasks = new Map();\n    const pdfDoc = ref(null);\n    const pageCount = ref(0);\n    const totalHeight = ref(0);\n    const pageDimensions = ref([]);\n    const visiblePages = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n    const viewportHeight = ref(0);\n\n    // 初始化 PDF\n    const initPDF = async () => {\n      try {\n        loading.value = true;\n        error.value = null;\n\n        // 加载 PDF 文档\n        const loadingTask = pdfjsLib.getDocument({\n          url: props.pdfUrl,\n          disableAutoFetch: true,\n          disableStream: true\n        });\n        pdfDoc.value = await loadingTask.promise;\n        pageCount.value = pdfDoc.value.numPages;\n        pageCanvases.value = new Array(pageCount.value).fill(null);\n\n        // 计算页面尺寸\n        await calculatePageDimensions();\n        updateVisiblePages();\n      } catch (err) {\n        console.error('PDF 初始化失败:', err);\n        error.value = `加载失败: ${err.message}`;\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 计算页面尺寸\n    const calculatePageDimensions = async () => {\n      const dimensions = [];\n      let currentOffset = 0;\n      for (let i = 1; i <= pageCount.value; i++) {\n        const page = await pdfDoc.value.getPage(i);\n        const viewport = page.getViewport({\n          scale: props.scale\n        });\n        dimensions.push({\n          pageNumber: i,\n          height: viewport.height,\n          width: viewport.width,\n          offset: currentOffset\n        });\n        currentOffset += viewport.height;\n      }\n      pageDimensions.value = dimensions;\n      totalHeight.value = currentOffset;\n    };\n\n    // 设置 Canvas 引用\n    const setCanvasRef = (el, pageNumber) => {\n      if (el) {\n        pageCanvases.value[pageNumber - 1] = el;\n        // 立即渲染可见页面\n        if (visiblePages.value.some(p => p.pageNumber === pageNumber)) {\n          renderPage(pageNumber);\n        }\n      }\n    };\n\n    // 渲染页面\n    const renderPage = async pageNumber => {\n      if (!pdfDoc.value || renderTasks.has(pageNumber)) return;\n      try {\n        const page = await pdfDoc.value.getPage(pageNumber);\n        const canvas = pageCanvases.value[pageNumber - 1];\n        if (!canvas) return;\n        const dimension = pageDimensions.value[pageNumber - 1];\n        const viewport = page.getViewport({\n          scale: props.scale\n        });\n\n        // 确保 Canvas 尺寸正确\n        canvas.width = dimension.width;\n        canvas.height = dimension.height;\n        const task = page.render({\n          canvasContext: canvas.getContext('2d'),\n          viewport: viewport\n        });\n        renderTasks.set(pageNumber, task);\n        await task.promise;\n      } catch (err) {\n        if (err.name !== 'RenderingCancelledException') {\n          console.error(`页面 ${pageNumber} 渲染失败:`, err);\n        }\n      } finally {\n        renderTasks.delete(pageNumber);\n      }\n    };\n\n    // 更新可见页面\n    const updateVisiblePages = () => {\n      if (!scrollContainer.value || pageDimensions.value.length === 0) return;\n      viewportHeight.value = scrollContainer.value.clientHeight;\n      const scrollTop = scrollContainer.value.scrollTop;\n      const bufferHeight = viewportHeight.value * props.bufferPages;\n      const startY = Math.max(0, scrollTop - bufferHeight);\n      const endY = scrollTop + viewportHeight.value + bufferHeight;\n      visiblePages.value = pageDimensions.value.filter(page => page.offset + page.height > startY && page.offset < endY);\n\n      // 批量渲染可见页面\n      visiblePages.value.forEach(page => {\n        if (pageCanvases.value[page.pageNumber - 1]) {\n          renderPage(page.pageNumber);\n        }\n      });\n    };\n\n    // 滚动处理\n    const handleScroll = () => {\n      requestAnimationFrame(updateVisiblePages);\n    };\n\n    // 窗口大小变化处理\n    const handleResize = () => {\n      if (pdfDoc.value) {\n        calculatePageDimensions().then(updateVisiblePages);\n      }\n    };\n\n    // 生命周期\n    onMounted(() => {\n      initPDF();\n      window.addEventListener('resize', handleResize);\n    });\n    onUnmounted(() => {\n      renderTasks.forEach(task => task.cancel());\n      renderTasks.clear();\n      window.removeEventListener('resize', handleResize);\n      if (pdfDoc.value) {\n        pdfDoc.value.destroy();\n        pdfDoc.value = null;\n      }\n    });\n    const __returned__ = {\n      setupPDFWorker,\n      props,\n      scrollContainer,\n      pageCanvases,\n      renderTasks,\n      pdfDoc,\n      pageCount,\n      totalHeight,\n      pageDimensions,\n      visiblePages,\n      loading,\n      error,\n      viewportHeight,\n      initPDF,\n      calculatePageDimensions,\n      setCanvasRef,\n      renderPage,\n      updateVisiblePages,\n      handleScroll,\n      handleResize,\n      ref,\n      onMounted,\n      onUnmounted,\n      get pdfjsLib() {\n        return pdfjsLib;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","pdfjsLib","setupPDFWorker","then","worker","GlobalWorkerOptions","workerSrc","default","console","warn","disableWorker","props","__props","scrollContainer","pageCanvases","renderTasks","Map","pdfDoc","pageCount","totalHeight","pageDimensions","visiblePages","loading","error","viewportHeight","initPDF","value","loadingTask","getDocument","url","pdfUrl","disableAutoFetch","disableStream","promise","numPages","Array","fill","calculatePageDimensions","updateVisiblePages","err","message","dimensions","currentOffset","i","page","getPage","viewport","getViewport","scale","push","pageNumber","height","width","offset","setCanvasRef","el","some","p","renderPage","has","canvas","dimension","task","render","canvasContext","getContext","set","name","delete","length","clientHeight","scrollTop","bufferHeight","bufferPages","startY","Math","max","endY","filter","forEach","handleScroll","requestAnimationFrame","handleResize","window","addEventListener","cancel","clear","removeEventListener","destroy"],"sources":["D:/Study/Code/AICloud/front/src/components/PDFViewer.vue"],"sourcesContent":["<template>\r\n  <div class=\"pdf-viewer-container\">\r\n    <div class=\"pdf-scroll-container\" ref=\"scrollContainer\" @scroll=\"handleScroll\">\r\n      <div class=\"pdf-pages-container\" :style=\"{ height: totalHeight + 'px' }\">\r\n        <div\r\n          v-for=\"page in visiblePages\"\r\n          :key=\"page.pageNumber\"\r\n          class=\"pdf-page-container\"\r\n          :style=\"{\r\n            top: page.offset + 'px',\r\n            height: page.height + 'px',\r\n            width: '100%'\r\n          }\"\r\n        >\r\n          <canvas\r\n            :ref=\"el => setCanvasRef(el, page.pageNumber)\"\r\n            :width=\"page.width\"\r\n            :height=\"page.height\"\r\n          ></canvas>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div v-if=\"loading\" class=\"loading-indicator\">加载中...</div>\r\n    <div v-if=\"error\" class=\"error-message\">{{ error }}</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted } from 'vue'\r\nimport * as pdfjsLib from 'pdfjs-dist/build/pdf'\r\n// import pdfjsWorker from 'pdfjs-dist/build/pdf.worker.min?url'\r\n\r\n// 配置 PDF.js worker\r\n// pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorker\r\n// pdfjsLib.GlobalWorkerOptions.workerSrc =\r\n//   'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.worker.min.js'\r\n\r\nconst setupPDFWorker = () => {\r\n  try {\r\n    // 尝试方案1：Vite专用导入\r\n    import('pdfjs-dist/build/pdf.worker.min?url').then(worker => {\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc = worker.default\r\n    })\r\n  } catch {\r\n    try {\r\n      // 方案2：使用CDN回退\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc =\r\n        'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.worker.min.js'\r\n    } catch {\r\n      // 方案3：降级模式\r\n      console.warn('使用无Worker模式，性能可能受影响')\r\n      pdfjsLib.disableWorker = true\r\n    }\r\n  }\r\n}\r\n\r\nconst props = defineProps({\r\n  pdfUrl: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  scale: {\r\n    type: Number,\r\n    default: 1.5\r\n  },\r\n  bufferPages: {\r\n    type: Number,\r\n    default: 2\r\n  }\r\n})\r\n\r\n// Refs\r\nconst scrollContainer = ref(null)\r\nconst pageCanvases = ref([])\r\nconst renderTasks = new Map()\r\nconst pdfDoc = ref(null)\r\nconst pageCount = ref(0)\r\nconst totalHeight = ref(0)\r\nconst pageDimensions = ref([])\r\nconst visiblePages = ref([])\r\nconst loading = ref(true)\r\nconst error = ref(null)\r\nconst viewportHeight = ref(0)\r\n\r\n// 初始化 PDF\r\nconst initPDF = async () => {\r\n  try {\r\n    loading.value = true\r\n    error.value = null\r\n\r\n    // 加载 PDF 文档\r\n    const loadingTask = pdfjsLib.getDocument({\r\n      url: props.pdfUrl,\r\n      disableAutoFetch: true,\r\n      disableStream: true\r\n    })\r\n\r\n    pdfDoc.value = await loadingTask.promise\r\n    pageCount.value = pdfDoc.value.numPages\r\n    pageCanvases.value = new Array(pageCount.value).fill(null)\r\n\r\n    // 计算页面尺寸\r\n    await calculatePageDimensions()\r\n    updateVisiblePages()\r\n  } catch (err) {\r\n    console.error('PDF 初始化失败:', err)\r\n    error.value = `加载失败: ${err.message}`\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 计算页面尺寸\r\nconst calculatePageDimensions = async () => {\r\n  const dimensions = []\r\n  let currentOffset = 0\r\n\r\n  for (let i = 1; i <= pageCount.value; i++) {\r\n    const page = await pdfDoc.value.getPage(i)\r\n    const viewport = page.getViewport({ scale: props.scale })\r\n\r\n    dimensions.push({\r\n      pageNumber: i,\r\n      height: viewport.height,\r\n      width: viewport.width,\r\n      offset: currentOffset\r\n    })\r\n\r\n    currentOffset += viewport.height\r\n  }\r\n\r\n  pageDimensions.value = dimensions\r\n  totalHeight.value = currentOffset\r\n}\r\n\r\n// 设置 Canvas 引用\r\nconst setCanvasRef = (el, pageNumber) => {\r\n  if (el) {\r\n    pageCanvases.value[pageNumber - 1] = el\r\n    // 立即渲染可见页面\r\n    if (visiblePages.value.some(p => p.pageNumber === pageNumber)) {\r\n      renderPage(pageNumber)\r\n    }\r\n  }\r\n}\r\n\r\n// 渲染页面\r\nconst renderPage = async (pageNumber) => {\r\n  if (!pdfDoc.value || renderTasks.has(pageNumber)) return\r\n\r\n  try {\r\n    const page = await pdfDoc.value.getPage(pageNumber)\r\n    const canvas = pageCanvases.value[pageNumber - 1]\r\n    if (!canvas) return\r\n\r\n    const dimension = pageDimensions.value[pageNumber - 1]\r\n    const viewport = page.getViewport({ scale: props.scale })\r\n\r\n    // 确保 Canvas 尺寸正确\r\n    canvas.width = dimension.width\r\n    canvas.height = dimension.height\r\n\r\n    const task = page.render({\r\n      canvasContext: canvas.getContext('2d'),\r\n      viewport: viewport\r\n    })\r\n\r\n    renderTasks.set(pageNumber, task)\r\n    await task.promise\r\n  } catch (err) {\r\n    if (err.name !== 'RenderingCancelledException') {\r\n      console.error(`页面 ${pageNumber} 渲染失败:`, err)\r\n    }\r\n  } finally {\r\n    renderTasks.delete(pageNumber)\r\n  }\r\n}\r\n\r\n// 更新可见页面\r\nconst updateVisiblePages = () => {\r\n  if (!scrollContainer.value || pageDimensions.value.length === 0) return\r\n\r\n  viewportHeight.value = scrollContainer.value.clientHeight\r\n  const scrollTop = scrollContainer.value.scrollTop\r\n  const bufferHeight = viewportHeight.value * props.bufferPages\r\n\r\n  const startY = Math.max(0, scrollTop - bufferHeight)\r\n  const endY = scrollTop + viewportHeight.value + bufferHeight\r\n\r\n  visiblePages.value = pageDimensions.value.filter(\r\n    page => page.offset + page.height > startY && page.offset < endY\r\n  )\r\n\r\n  // 批量渲染可见页面\r\n  visiblePages.value.forEach(page => {\r\n    if (pageCanvases.value[page.pageNumber - 1]) {\r\n      renderPage(page.pageNumber)\r\n    }\r\n  })\r\n}\r\n\r\n// 滚动处理\r\nconst handleScroll = () => {\r\n  requestAnimationFrame(updateVisiblePages)\r\n}\r\n\r\n// 窗口大小变化处理\r\nconst handleResize = () => {\r\n  if (pdfDoc.value) {\r\n    calculatePageDimensions().then(updateVisiblePages)\r\n  }\r\n}\r\n\r\n// 生命周期\r\nonMounted(() => {\r\n  initPDF()\r\n  window.addEventListener('resize', handleResize)\r\n})\r\n\r\nonUnmounted(() => {\r\n  renderTasks.forEach(task => task.cancel())\r\n  renderTasks.clear()\r\n  window.removeEventListener('resize', handleResize)\r\n\r\n  if (pdfDoc.value) {\r\n    pdfDoc.value.destroy()\r\n    pdfDoc.value = null\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.pdf-viewer-container {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background: #f5f5f5;\r\n}\r\n\r\n.pdf-scroll-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow-y: auto;\r\n  position: relative;\r\n}\r\n\r\n.pdf-pages-container {\r\n  position: relative;\r\n  width: 100%;\r\n}\r\n\r\n.pdf-page-container {\r\n  position: absolute;\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  padding: 20px 0;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.pdf-page-container canvas {\r\n  background: white;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  max-width: 100%;\r\n}\r\n\r\n.loading-indicator,\r\n.error-message {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  padding: 12px 24px;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n}\r\n\r\n.loading-indicator {\r\n  background: rgba(0, 0, 0, 0.7);\r\n  color: white;\r\n}\r\n\r\n.error-message {\r\n  background: #ffebee;\r\n  color: #c62828;\r\n  border: 1px solid #ef9a9a;\r\n  max-width: 80%;\r\n  text-align: center;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}